---
import { getCollection, render } from "astro:content";
import { SITE } from "@data/config";
import DocsLayout from "@/layouts/DocsLayout.astro";
import MdxImage from "@/components/docs/markdown/MdxImage.astro";
import MdxLink from "@/components/docs/markdown/MdxLink.astro";

// Render the docs `index` page instead of redirecting
const docs = await getCollection("docs");
const doc = docs.find((d) => d.id === "index");

// Fallback to redirect if index doc is missing
if (!doc) {
    return Astro.redirect(SITE.defaultDocRedirect ?? "/");
}

const { Content, headings } = await render(doc);

const components = {
    img: MdxImage,
    a: MdxLink,
};
---

<DocsLayout frontmatter={doc} headings={headings}>
    <Content components={components} />
</DocsLayout>
