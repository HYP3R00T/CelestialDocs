---
import { getCollection, render } from "astro:content";
import DocsLayout from "@/layouts/DocsLayout.astro";
import MdxImage from "@/components/docs/markdown/MdxImage.astro";
import MdxLink from "@/components/docs/markdown/MdxLink.astro";

export async function getStaticPaths() {
    const docs = await getCollection("docs");

    return docs.map((doc) => ({
        params: { slug: doc.id },
        props: { doc },
    }));
}

const { doc } = Astro.props;
const { Content, headings } = await render(doc);

const { title, description, authors } = doc.data;

const components = {
    img: MdxImage,
    a: MdxLink,
};
---

<DocsLayout
    title={title}
    description={description}
    currentSlug={doc.id}
    contentType="article"
    headings={headings}
>
    <h1>{title}</h1>
    {description && <p class="lead">{description}</p>}
    {
        authors && authors.length > 0 && (
            <p class="text-sm text-muted-foreground mb-2">
                By {authors.map((a) => `@${a}`).join(", ")}
            </p>
        )
    }
    <Content components={components} />
</DocsLayout>
