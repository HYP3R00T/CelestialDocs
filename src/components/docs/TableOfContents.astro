---
import type { TableOfContentsProps } from "@/lib/types";

const { headings = [] } = Astro.props as TableOfContentsProps;

// Filter to only include h2 and h3 headings for the TOC
const filteredHeadings = headings.filter((h) => h.depth === 2 || h.depth === 3);
---

{
    filteredHeadings.length > 0 && (
        <aside class="sticky top-17 hidden h-[calc(100vh-4.25rem)] overflow-y-auto bg-background xl:block">
            <nav
                aria-label="Table of contents"
                class="flex h-full flex-col px-4 py-6"
            >
                <h3 class="mb-4 text-sm font-semibold text-foreground">
                    On this page
                </h3>
                <ul class="space-y-2 text-sm">
                    {filteredHeadings.map((heading) => (
                        <li class={heading.depth === 3 ? "ml-4" : ""}>
                            <a
                                href={`#${heading.id}`}
                                class="text-muted-foreground transition-colors hover:text-foreground"
                            >
                                {heading.text}
                            </a>
                        </li>
                    ))}
                </ul>
            </nav>
        </aside>
    )
}

<style>
    aside {
        width: 280px;
    }

    @media (max-width: 1280px) {
        aside {
            display: none;
        }
    }
</style>
