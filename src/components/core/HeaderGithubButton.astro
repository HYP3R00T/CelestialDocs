---
import { Icon } from "astro-icon/components";
import { Button } from "@/components/ui/button";
import { SITE, HEADER_FEATURES } from "@data/config";
import type { HeaderGithubButtonProps } from "@/lib/types";

// Component accepts no props
Astro.props as HeaderGithubButtonProps;
---

<Button variant="ghost">
    <a
        id="github-star-button"
        href={SITE.repo}
        target="_blank"
        rel="noopener noreferrer"
        data-repo={SITE.repo}
        data-threshold={HEADER_FEATURES.starCountThreshold}
        class="flex items-center gap-2"
    >
        <Icon name="github" class="size-5" />
        <span
            id="github-star-count"
            class="text-xs font-medium text-muted-foreground hidden"
            aria-live="polite"></span>
    </a>
</Button>

<script>
    import { initGitHubStars } from "@/lib/github";
    document.addEventListener("astro:page-load", initGitHubStars);
</script>
