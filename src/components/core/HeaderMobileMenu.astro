---
import { Icon } from "astro-icon/components";
import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";
import { Socials, navItems } from "@data/config";

const activeSocials = Socials.filter((social) => social.active);
const menuPanelId = "mobile-menu";
const menuButtonId = "mobile-menu-btn";
---

<div
    id={menuPanelId}
    class="fixed inset-0 z-40 hidden md:hidden bg-background"
    aria-hidden="true"
>
    <div class="flex h-full w-full flex-col px-4 pb-4 pt-19 overflow-hidden">
        <div
            class="mx-auto w-full max-w-md rounded-lg border border-border/50 bg-linear-to-b from-background/85 via-background/95 to-background/98 shadow-xl max-h-[calc(100vh-5.5rem)] overflow-y-auto"
        >
            <div class="flex flex-col gap-6 px-6 py-6">
                <nav
                    class="flex flex-col items-center gap-3 text-sm font-medium"
                >
                    {
                        navItems.map(({ href, label, special, blank }) => (
                            <a
                                href={href}
                                target={blank ? "_blank" : undefined}
                                rel={blank ? "noreferrer" : undefined}
                                class={`tracking-wide transition hover:text-primary ${special ? "text-primary" : "text-muted-foreground"}`}
                            >
                                {label}
                            </a>
                        ))
                    }
                </nav>

                <div
                    class="flex items-center justify-center gap-3 border-t border-border/40 pt-4"
                >
                    {
                        activeSocials.map(({ name, href, linkTitle }) => (
                            <Button
                                key={name}
                                variant="ghost"
                                size="icon"
                                asChild
                            >
                                <a
                                    href={href}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    aria-label={linkTitle ?? name}
                                >
                                    <Icon name={name} class="size-5" />
                                </a>
                            </Button>
                        ))
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    import { initMobileMenu } from "@/lib/menu";
    document.addEventListener("astro:page-load", initMobileMenu);
</script>
